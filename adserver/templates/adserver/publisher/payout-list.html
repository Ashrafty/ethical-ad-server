{% extends "adserver/base.html" %}
{% load humanize %}
{% load i18n %}


{% block title %}{% trans 'Publisher payouts' %} - {{ publisher }}{% endblock %}


{% block breadcrumbs %}
  {{ block.super }}
  <li class="breadcrumb-item"><a href="{% url 'publisher_main' publisher.slug %}">{{ publisher }}</a></li>
  <li class="breadcrumb-item active">{% trans 'Payouts' %}</li>
{% endblock breadcrumbs %}


{% block content_container %}

<h1>{% block heading %}{% trans "Publisher payouts" %}{% endblock heading %}</h1>


  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th><strong>{% trans 'Date' %}</strong></th>
          <th><strong>{% trans 'Amount' %}</strong></th>
        </tr>
      </thead>
      <tbody>
        {% for payout in payouts %}
          <tr>
            <td>
              <a href="{% url 'publisher_payout' publisher.slug payout.pk %}">{{ payout.date|date:"M j, Y" }}</a>
            </td>
            <td>${{ payout.amount|floatformat:2|intcomma }}</td>
          </tr>
        {% endfor %}

        {% if last_payout.last_paid_month.month != last_month.month %}
          <tr>
            <td>
              <a href="{% url 'publisher_report' publisher.slug %}?start_date={{ last_payout.date|date:"Y-m-01" }}&end_date={{ last_month|date:"Y-m-d" }}">Balance until end of {{ last_month|date:"M" }}</a>
            </td>
            <td>${{ due_balance|floatformat:2|intcomma }}</td>
          </tr>
        {% endif %}

          <tr>
            <td>
              <a href="{% url 'publisher_report' publisher.slug %}?start_date={{ today|date:"Y-m-01" }}&end_date={{ today|date:"Y-m-d" }}">Balance this month</a>
            </td>
            <td>${{ this_month_balance|floatformat:2|intcomma }}</td>
          </tr>
      </tbody>
      <tfoot>
        <tr>
          <td><strong>{% trans 'Total' %}</strong> </td>
          <td><strong>${{ total_balance|floatformat:2|intcomma }}</strong></td>
        </tr>
      </tfoot>
    </table>
  </div>

{% endblock content_container %}
